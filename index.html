<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8" />
		<title>Island Mystery Game</title>
		<script type="text/javascript" src="MV.js"></script>
		<script type="text/javascript" src="webgl-utils.js"></script>
		<script type="text/javascript" src="initShaders.js"></script>
		<script type="text/javascript" src="camera.js"></script>
		<script type="text/javascript" src="texture.js"></script>
		<script type="text/javascript" src="shapes/shape.js"></script>
		<script type="text/javascript" src="shapes/cube.js"></script>
		<script type="text/javascript" src="scene.js"></script>

		<script id="shader-vertex" type="x-shader/x-vertex">
			precision mediump float;

			// Position attributes and uniforms
			attribute vec3 vPosition;
			attribute vec3 vNormal;
			attribute vec2 texCoord;
			uniform mat4 modelMatrix;
			uniform mat4 projViewMatrix;
			uniform mat4 normalMat;

			// Material uniforms
			uniform vec4 ambientProduct;
			uniform vec4 diffuseProduct;
			uniform vec3 lightPosition;

			varying vec2 fUV;
			varying vec4 fColor;
			void main() {
				// Make sure our w components are set properly
				vec4 pos  = vec4(vPosition, 1.0);
				vec4 norm = vec4(vNormal, 0.0);

				vec3 posInWorld    = (modelMatrix * pos).xyz;
				vec3 normalInWorld = (normalMat * norm).xyz;
				vec3 lightInWorld  = lightPosition; // Light already in world coordinates

				// We ignore specular highlights
				vec3 N = normalize(normalInWorld);
				vec3 L = normalize(lightInWorld - posInWorld);
				vec3 E = normalize(-posInWorld);

				float dotLN = dot(L, N);
				float Kd = max(dotLN, 0.0);

				vec4 ambient  = ambientProduct;
				vec4 diffuse  = Kd * diffuseProduct;

				fUV = texCoord;
				fColor = ambient + diffuse;
				fColor.a = 1.0;

				gl_Position = projViewMatrix * vec4(posInWorld, 1.0);
			}
		</script>

		<script id="shader-fragment" type="x-shader/x-fragment">
			precision mediump float;
			uniform sampler2D uSampler;
			varying vec4 fColor;
			varying vec2 fUV;
			void main() {
				gl_FragColor = fColor * texture2D(uSampler, fUV);
			}
		</script>

		<style>
			.columns {
				columns: 2;
				-webkit-columns: 2;
				-moz-columns: 2;
			}
		</style>
	</head>
	<body>
		<div style="width: 640px; margin: auto;">
			<center>
				<h2>Island Mystery Game</h2>
				<h3>Kyle Kodani, Kevin Lu, Ivan Petkov, Xiaosong Shi, David Vasko</h3>
			</center>

			<canvas id="gl-canvas" width="640" height="480" class="centered">
				Sorry, your browser does not support WebGL.
			</canvas>

			<br />
			<center><strong>Controls</strong></center>
			<ul class="columns">
				<li>Change elevation with <strong>Up</strong>/<strong>Down</strong> arrows</li>
				<li>Turn with <strong>Left</strong>/<strong>Right</strong> arrows</li>
				<li>Move forward/backward with <strong>I</strong>/<strong>K</strong></li>
				<li>Strafe left with <strong>J</strong> and right with <strong>L</strong> or <strong>M</strong></li>
				<li>Roll left/right with <strong>U</strong>/<strong>O</strong></li>
				<li>Zoom in/out with <strong>N</strong>/<strong>W</strong></li>
				<li>Pitch up/down with <strong>;</strong>/<strong>P</strong></li>
			</ul>
		</div>
	</body>
</html>
